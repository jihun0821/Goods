<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MIXX HANIL MARKET</title>
    <link rel="icon" href="images/favicon.png"/> 
    <link rel="stylesheet" href="styles.css">
    
    <style>  
    /* ìŒì•… í”Œë ˆì´ì–´ ìŠ¤íƒ€ì¼ */
    .music-player {
        border: 2px solid #333;
        border-radius: 8px;
        padding: 20px;
        margin: 15px 0;
        background-color: #fff;
        text-align: center;
    }

    .music-btn {
        width: 100%;
        padding: 15px 20px;
        font-size: 20px;
        font-weight: bold;
        border: 2px solid #333;
        border-radius: 8px;
        background-color: white;
        cursor: pointer;
        transition: all 0.3s;
        font-family: 'Nanum Pen Script', cursive, sans-serif;
        margin-bottom: 10px;
    }

    .music-btn:hover {
        background-color: #27AE60;
        color: white;
    }

    .music-btn:active {
        transform: scale(0.98);
    }

    .now-playing {
        font-size: 16px;
        color: #666;
        margin-top: 10px;
        min-height: 20px;
        word-break: break-all;
        font-family: 'Nanum Pen Script', cursive, sans-serif;
    }

    .music-controls {
        display: flex;
        gap: 10px;
        margin-top: 15px;
    }

    .control-btn {
        flex: 1;
        padding: 12px;
        font-size: 18px;
        font-weight: bold;
        border: 2px solid #333;
        border-radius: 8px;
        background-color: white;
        cursor: pointer;
        transition: all 0.3s;
        font-family: 'Nanum Pen Script', cursive, sans-serif;
    }

    .control-btn:hover {
        background-color: #f0f0f0;
    }
    </style>
    
    <script type="module">
      import {
        initializeApp
      } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
  
      import {
        getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword,
        signOut, onAuthStateChanged, updateProfile, sendPasswordResetEmail 
      } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

      import {
        getFirestore, doc, setDoc, getDoc, collection, addDoc, getDocs, query, orderBy
      } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

      import {
        getStorage, ref, uploadBytes, getDownloadURL
      } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js';

      window.firebase = {
        initializeApp,
        getAuth,
        createUserWithEmailAndPassword,
        signInWithEmailAndPassword,
        signOut,
        onAuthStateChanged,
        sendPasswordResetEmail,
        updateProfile,
        getFirestore,
        doc,
        setDoc,
        getDoc,
        collection,
        addDoc,
        getDocs,
        query,
        orderBy,
        getStorage,
        ref,
        uploadBytes,
        getDownloadURL
      };
    </script>
</head>
<body>
    <!-- ë©”ë‰´ ë²„íŠ¼ -->
    <div class="menu-button" onclick="toggleSidebar()">
        <span></span>
        <span></span>
        <span></span>
    </div>

    <!-- ì˜¤ë²„ë ˆì´ -->
    <div class="overlay" id="overlay" onclick="toggleSidebar()"></div>

    <!-- ì‚¬ì´ë“œë°” -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-section">
            <img src="images/logo.png" alt="ë¯¹ìŠ¤í•œì¼ë§ˆì¼“ ë¡œê³ " style="max-width: 160px; height: auto; display: block; margin: 0 auto 12px auto;">
            <div class="login-box" onclick="openProductModal()">ì œí’ˆ ë“±ë¡í•˜ê¸°</div>
            <div class="login-box" id="loginButton" onclick="openLoginModal()">LOGIN</div>
        </div>
        
        <div class="sidebar-section">
            <h2>íšŒì› ì •ë³´</h2>
            <ul class="option-list">
                <li id="userInfo">- ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤</li>
                <li style="cursor: pointer;" onclick="location.href='list.html'">- ë‚´ êµ¬ë§¤ëª©ë¡</li>
                <li>- ì‚¬ì´íŠ¸ ì„¤ëª…</li>
            </ul>
        </div>

        <div class="sidebar-section">
            <ul class="option-list">
              <li style="cursor: pointer;" onclick="location.href='manage.html'">- ê´€ë¦¬ í˜ì´ì§€</li>
              <li style="margin-top: 15px;">
                <div class="music-player">
                  <button id="playBtn" class="music-btn">â–¶ ìŒì•… ì¬ìƒ</button>
                  <div class="music-controls">
                      <button id="pauseBtn" class="control-btn">â¸ ì¼ì‹œì •ì§€</button>
                      <button id="nextBtn" class="control-btn">â­ ë‹¤ìŒê³¡</button>
                  </div>
                  <div id="nowPlaying" class="now-playing"></div>
                </div>
              </li>
            </ul>
        </div>
    </div>

    <!-- ë©”ì¸ ì»¨í…ì¸  -->
    <div class="main-content">
        <!-- ì¹´ë“œ ì„¹ì…˜ -->
        <div class="cards-section">
            <div class="cards-container" id="cardsContainer">
                <!-- ì œí’ˆ ì¹´ë“œë“¤ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
            </div>
        </div>
    </div>

    <!-- ë¡œê·¸ì¸ ëª¨ë‹¬ -->
    <div id="loginModal" class="auth-modal">
       <div class="auth-modal-content">
         <span class="auth-modal-close" onclick="closeAllModals()">&times;</span>
         <h2>ë¡œê·¸ì¸</h2>
         <div class="auth-form">
           <input id="loginEmail" type="email" placeholder="ì•„ì´ë””(ì´ë©”ì¼)" autocomplete="username" />
           <input id="loginPassword" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸" autocomplete="current-password" />
           <button onclick="handleLogin()" class="auth-btn">ë¡œê·¸ì¸</button>
         </div>
        <div class="auth-links">
          <a onclick="openSignupModal()">ê°€ì…í•˜ê¸°</a>
          <a onclick="openPasswordResetModal()">ë¹„ë°€ë²ˆí˜¸ë¥¼ ìŠì–´ë²„ë¦¬ì…¨ë‚˜ìš”?</a>
        </div>
       </div>
    </div>

    <!-- íšŒì›ê°€ì… ëª¨ë‹¬ -->
    <div id="signupModal" class="auth-modal">
       <div class="auth-modal-content">
         <span class="auth-modal-close" onclick="closeAllModals()">&times;</span>
         <h2>íšŒì›ê°€ì…</h2>
         <div class="auth-form">
           <input id="signupEmail" type="email" placeholder="ì´ë©”ì¼ (@hanilgo.cnehs.kr)" />
           <input id="signupPassword" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸ (6ì ì´ìƒ)" />
           <button onclick="handleSignupNext()" class="auth-btn">ë‹¤ìŒ</button>
         </div>
         <div class="auth-links">
           <a onclick="openLoginModal()">ë¡œê·¸ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
         </div>
       </div>
    </div>

    <!-- í”„ë¡œí•„ ì„¤ì • ëª¨ë‹¬ (íšŒì›ê°€ì… ì™„ë£Œìš©) -->
    <div id="profileModal" class="auth-modal">
        <div class="auth-modal-content">
            <span class="auth-modal-close" onclick="closeAllModals()">&times;</span>
            <h2>í”„ë¡œí•„ ì„¤ì •</h2>
            <div class="auth-form">
                <p>ë‹‰ë„¤ì„ì„ ì„¤ì •í•´ì£¼ì„¸ìš”. (2-20ì)</p>
                <input id="nickname" type="text" placeholder="ë‹‰ë„¤ì„ ì…ë ¥" maxlength="20" />
                <button onclick="handleSignupComplete()" class="auth-btn">ì €ì¥í•˜ê³  ê°€ì…</button>
            </div>
        </div>
    </div>

    <!-- ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ëª¨ë‹¬ -->
    <div id="passwordResetModal" class="auth-modal">
      <div class="auth-modal-content">
        <span class="auth-modal-close" onclick="closeAllModals()">&times;</span>
        <h2>ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •</h2>
        <div class="auth-form">
          <p>ê°€ì…í•  ë•Œ ì‚¬ìš©í•œ ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ë©´ ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ë§í¬ë¥¼ ë³´ë‚´ë“œë¦½ë‹ˆë‹¤.</p>
          <input id="resetEmail" type="email" placeholder="ì´ë©”ì¼ ì£¼ì†Œ ì…ë ¥" />
          <button onclick="handlePasswordReset()" class="auth-btn">ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ì´ë©”ì¼ ë³´ë‚´ê¸°</button>
        </div>
        <div class="auth-links">
          <a onclick="openLoginModal()">ë¡œê·¸ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
        </div>
      </div>
    </div>

    <!-- ì œí’ˆ ë“±ë¡ ëª¨ë‹¬ -->
    <div id="productModal" class="auth-modal">
      <div class="auth-modal-content">
        <span class="auth-modal-close" onclick="closeAllModals()">&times;</span>
        <h2>ì œí’ˆ ë“±ë¡</h2>
        <div class="auth-form">
          <input id="productImage" type="file" accept="image/*" class="file-input" />
          <div id="imagePreview" class="image-preview"></div>
          <input id="productName" type="text" placeholder="ì œí’ˆ ì´ë¦„" />
          <input id="productPrice" type="number" placeholder="ê°€ê²© (ì›)" min="0" />
          <textarea id="productDescription" placeholder="ì œí’ˆ ì„¤ëª…" rows="4"></textarea>

          <!-- ì‚¬ì´ì¦ˆ ì˜µì…˜ ì¶”ê°€ -->
          <div class="checkbox-group">
            <label><input id="productHasSize" type="checkbox" /> ì‚¬ì´ì¦ˆ ì˜µì…˜ ì„¤ì •</label>
          </div>
          <input id="productSizes" type="text" placeholder="ì˜ˆ: S,M,L ë˜ëŠ” 250,255 (ì½¤ë§ˆë¡œ êµ¬ë¶„)" class="product-size-input" style="display:none;" />

          <button onclick="handleProductSubmit()" class="auth-btn">ì œí’ˆ ë“±ë¡í•˜ê¸°</button>
        </div>
      </div>
    </div>

    <!-- ì œí’ˆ ìƒì„¸ ëª¨ë‹¬ -->
    <div id="detailModal" class="auth-modal">
      <div class="auth-modal-content detail-modal-content">
        <span class="auth-modal-close" onclick="closeAllModals()">&times;</span>
        <h2 id="detailProductName">ì œí’ˆ ì´ë¦„</h2>
        <div class="detail-content">
          <div class="detail-image-box">
            <img id="detailProductImage" src="" alt="ì œí’ˆ ì´ë¯¸ì§€">
          </div>
          <div class="detail-info">
            <div class="detail-price-box">
              <span class="detail-label">ê°€ê²©:</span>
              <span id="detailProductPrice" class="detail-price">0ì›</span>
            </div>
            <div class="detail-description-box">
              <span class="detail-label">ì„¤ëª…:</span>
              <p id="detailProductDescription"></p>
            </div>
            <div class="detail-seller-box">
              <span class="detail-label">íŒë§¤ì:</span>
              <span id="detailSellerName"></span>
            </div>
            <div class="purchase-section">
              <!-- ì‚¬ì´ì¦ˆ ì…€ë ‰íŠ¸ëŠ” scriptì—ì„œ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ (id="purchaseSizeWrapper") -->
              <div class="quantity-selector">
                <button onclick="decreaseQuantity()" class="quantity-btn">-</button>
                <input id="purchaseQuantity" type="number" value="1" min="1" max="99" readonly />
                <button onclick="increaseQuantity()" class="quantity-btn">+</button>
              </div>
              <button onclick="handlePurchase()" class="auth-btn purchase-btn">êµ¬ë§¤í•˜ê¸°</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ê°œì¸ì •ë³´ ì…ë ¥ ëª¨ë‹¬ -->
    <div id="privacyModal" class="auth-modal">
      <div class="auth-modal-content">
        <span class="auth-modal-close" onclick="closeAllModals()">&times;</span>
        <h2>ê°œì¸ì •ë³´ ì…ë ¥</h2>
        <div class="auth-form">
          <p>ê°œì¸ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”. ëˆ„ê°€ ë­˜ ìƒ€ëŠ”ì§€ ì •í™•íˆ ì•Œê¸° ìœ„í•¨ì…ë‹ˆë‹¤.</p>
          <div class="select-group">
            <label>í•™ë…„</label>
            <select id="privacyGrade" class="privacy-select">
              <option value="">ì„ íƒ</option>
              <option value="1">1í•™ë…„</option>
              <option value="2">2í•™ë…„</option>
              <option value="3">3í•™ë…„</option>
            </select>
          </div>
          <div class="select-group">
            <label>ë°˜</label>
            <select id="privacyClass" class="privacy-select">
              <option value="">ì„ íƒ</option>
              <option value="1">1ë°˜</option>
              <option value="2">2ë°˜</option>
              <option value="3">3ë°˜</option>
              <option value="4">4ë°˜</option>
              <option value="5">5ë°˜</option>
            </select>
          </div>
          <div class="select-group">
            <label>ë²ˆí˜¸</label>
            <select id="privacyNumber" class="privacy-select">
              <option value="">ì„ íƒ</option>
              <option value="1">1ë²ˆ</option>
              <option value="2">2ë²ˆ</option>
              <option value="3">3ë²ˆ</option>
              <option value="4">4ë²ˆ</option>
              <option value="5">5ë²ˆ</option>
              <option value="6">6ë²ˆ</option>
              <option value="7">7ë²ˆ</option>
              <option value="8">8ë²ˆ</option>
              <option value="9">9ë²ˆ</option>
              <option value="10">10ë²ˆ</option>
              <option value="11">11ë²ˆ</option>
              <option value="12">12ë²ˆ</option>
              <option value="13">13ë²ˆ</option>
              <option value="14">14ë²ˆ</option>
              <option value="15">15ë²ˆ</option>
              <option value="16">16ë²ˆ</option>
              <option value="17">17ë²ˆ</option>
              <option value="18">18ë²ˆ</option>
              <option value="19">19ë²ˆ</option>
              <option value="20">20ë²ˆ</option>
              <option value="21">21ë²ˆ</option>
              <option value="22">22ë²ˆ</option>
              <option value="23">23ë²ˆ</option>
              <option value="24">24ë²ˆ</option>
              <option value="25">25ë²ˆ</option>
              <option value="26">26ë²ˆ</option>
            </select>
          </div>
          <input id="privacyName" type="text" placeholder="ì´ë¦„ ì…ë ¥" maxlength="10" />
          <button onclick="handlePrivacySave()" class="auth-btn">ì €ì¥í•˜ê¸°</button>
        </div>
      </div>
    </div>

    <script src="script.js"></script>
    <script src="admin_ui_control.js"></script>
    
    <!-- ğŸµ ìŒì•… í”Œë ˆì´ì–´ ìŠ¤í¬ë¦½íŠ¸ -->
    <script>
      // GitHubì˜ MP3 íŒŒì¼ ê²½ë¡œë¥¼ ì—¬ê¸°ì— ì¶”ê°€í•˜ì„¸ìš”
      const songs = [
        "music/song1.mp3",
        "music/song2.mp3",
        "music/song3.mp3",
        "music/song4.mp3"
        // ì—¬ê¸°ì— GitHub URLë¡œ ë³€ê²½í•˜ê±°ë‚˜ ì¶”ê°€í•˜ì„¸ìš”
      ];

      let remaining = [...songs];
      let audio = new Audio();
      let isPlaying = false;

      const playBtn = document.getElementById("playBtn");
      const pauseBtn = document.getElementById("pauseBtn");
      const nextBtn = document.getElementById("nextBtn");
      const nowPlaying = document.getElementById("nowPlaying");

      function updateNowPlaying(songPath) {
        const songName = songPath.split('/').pop().replace('.mp3', '');
        nowPlaying.textContent = `ì¬ìƒì¤‘: ${songName}`;
      }

      function playRandomSong() {
        if (remaining.length === 0) {
          nowPlaying.textContent = "ëª¨ë“  ë…¸ë˜ë¥¼ ì¬ìƒí–ˆìŠµë‹ˆë‹¤!";
          remaining = [...songs];
          isPlaying = false;
          playBtn.textContent = "â–¶ ìŒì•… ì¬ìƒ";
          return;
        }

        const randomIndex = Math.floor(Math.random() * remaining.length);
        const selected = remaining[randomIndex];
        remaining.splice(randomIndex, 1);

        audio.src = selected;
        audio.play().catch(err => {
          console.error("ì¬ìƒ ì˜¤ë¥˜:", err);
          nowPlaying.textContent = "ì¬ìƒ ì˜¤ë¥˜ ë°œìƒ";
        });
        
        updateNowPlaying(selected);
        isPlaying = true;
        playBtn.textContent = "â¹ ì •ì§€";

        audio.onended = playRandomSong;
      }

      playBtn.addEventListener("click", () => {
        if (!isPlaying) {
          playRandomSong();
        } else {
          audio.pause();
          audio.currentTime = 0;
          isPlaying = false;
          playBtn.textContent = "â–¶ ìŒì•… ì¬ìƒ";
          nowPlaying.textContent = "";
          remaining = [...songs];
        }
      });

      pauseBtn.addEventListener("click", () => {
        if (isPlaying) {
          if (audio.paused) {
            audio.play();
            pauseBtn.textContent = "â¸ ì¼ì‹œì •ì§€";
          } else {
            audio.pause();
            pauseBtn.textContent = "â–¶ ì¬ìƒ";
          }
        }
      });

      nextBtn.addEventListener("click", () => {
        if (isPlaying) {
          audio.pause();
          playRandomSong();
          pauseBtn.textContent = "â¸ ì¼ì‹œì •ì§€";
        }
      });
    </script>
</body>
</html>
